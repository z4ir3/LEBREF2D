function [MESH] = lshapedomainunstruct
%LSHAPEDOMAINUNSTRUCT unstructured L-shaped domain grid generator
% L-shaped domain generated: (-1,1)^2 \ (-1,0]^2
%  output
% --------
%  MESH  : mesh data structure
%
% See also LSHAPEDOMAIN
%
% LEBREF2D function; Copyright (c) L. Rocchi  

% ------------------------------------------------------------
% Mesh
% ------------------------------------------------------------
% Vertices coordinates map
  xymap = [-1.0000    0.0000;  ...
           -1.0000    1.0000;  ...
           -1.0000    0.4520;  ...
           -0.6598    0.3281;  ...
           -0.6248    0.0000;  ...
           -0.5442    0.6874;  ...
           -0.3760    0.4793;  ...
           -0.3684    0.2070;  ...
           -0.3460    0.0000;  ...
           -0.1549    1.0000;  ...
           -0.1384    0.2735;  ...
           -0.1382    0.0000;  ...
           -0.1374    0.6031;  ...
            0.0000   -1.0000;  ...
            0.0000    0.0000;  ...
            0.0000   -0.3469;  ...
            0.0000   -0.6181;  ...
            0.0161    0.1237;  ...
            0.0786    0.3818;  ...
            0.1644    0.6815;  ...
            0.2034   -0.3070;  ...
            0.2174   -0.0710;  ...
            0.2720   -0.6326;  ...
            0.2873    0.1819;  ...
            0.3588    0.4198;  ...
            0.3630    1.0000;  ...
            0.4622   -0.3088;  ...
            0.4346   -1.0000;  ...
            0.4426   -0.0042;  ...
            0.5932    0.6326;  ...
            0.6921   -0.6433;  ...
            0.6255    0.2274;  ...
            0.6776   -0.1575;  ...
            1.0000    0.0232;  ...
            1.0000    0.4529;  ...
            1.0000   -0.4264;  ...
            1.0000   -1.0000;  ...
            1.0000    1.0000];
            
% Elements map
  elmap = [ 14    28    23;  ...
            23    17    14;  ...
            34    33    36;  ...
            17    23    21;  ...
            32    34    35;  ...
            32    33    34;  ...
            31    36    33;  ...
            31    23    28;  ...
            37    31    28;  ...
            36    31    37;  ...
             2     6    10;  ...
            13    10     6;  ...
            15    16    21;  ...
            21    16    17;  ...
            30    35    38;  ...
            30    32    35;  ...
            32    29    33;  ...
            33    27    31;  ...
            27    33    29;  ...
            27    21    23;  ...
            23    31    27;  ...
             6     2     3;  ...
             6     7    13;  ...
            30    25    32;  ...
            26    30    38;  ...
            21    22    15;  ...
            22    21    27;  ...
            27    29    22;  ...
            13     7    11;  ...
             3     4     6;  ...
             4     7     6;  ...
             1     5     4;  ...
             4     3     1;  ...
            24    29    32;  ...
            32    25    24;  ...
            22    29    24;  ...
            20    25    30;  ...
            26    20    30;  ...
            10    13    20;  ...
            10    20    26;  ...
             7     8    11;  ...
             4     8     7;  ...
             8     9    12;  ...
            12    11     8;  ...
             5     9     8;  ...
             5     8     4;  ...
            24    25    19;  ...
            20    19    25;  ...
            11    19    13;  ...
            13    19    20;  ...
            18    15    22;  ...
            24    18    22;  ...
            12    15    18;  ...
            12    18    11;  ...
            19    11    18;  ...
            19    18    24];
        
  MESH.coord = xymap;
  MESH.elem  = elmap;  
  
% Boundary elements/edges
  [MESH] = adjustunstructmesh(MESH);
  
% Interior vertices
  intvtx = [4 6 7 8 11 13 18 19 20 30 25 24 32 22 29 21 27 33 23 31]';
  
% Boundary vertices
  totvtx = 1:size(xymap,1);
  bdvtx  = totvtx(~ismember(totvtx,intvtx))';
  
% Update last fields of MESH structure
  MESH.int = intvtx;
  MESH.bnd = bdvtx;

end % end function